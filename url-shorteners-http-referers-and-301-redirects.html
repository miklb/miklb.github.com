<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>URL Shorteners, HTTP Referers and 301 Redirects</title>
    <meta name="description" content="I’ll start by saying I don’t know much about the subject, but am posting this in the hopes that someone who does can elucidate the issue.  My basic dilemma i...">
    <link rel="stylesheet" href= "/css/main.css">
    <link rel="canonical" href="https://miklb.com/url-shorteners-http-referers-and-301-redirects">
    <link rel="alternate" type="application/rss+xml" title="Miklb's Mindless Ramblings" href="https://miklb.com /feed.xml ">
    <link rel="shortcut icon" href="/public/favicon.png">
    <link rel="webmention" href="https://webmention.herokuapp.com/api/webmention" />
    <!-- Begin Jekyll SEO tag v1.3.3 -->
    <title>URL Shorteners, HTTP Referers and 301 Redirects - Miklb’s Mindless Ramblings</title>
    <meta property="og:title" content="URL Shorteners, HTTP Referers and 301 Redirects" />
    <meta name="description" content="I’ll start by saying I don’t know much about the subject, but am posting this in the hopes that someone who does can elucidate the issue.  My basic dilemma is that I have a short bit of code on my single page templates that checks to see if a visitor is from Twitter, and if so, show a little message.  (Not an original idea, I think I saw it on a post at Smashing Magazine).  The code they used didn’t work, but with the help of BigJibby in the Habari IRC channel, I was able to get it working with Habari." />
    <meta property="og:description" content="I’ll start by saying I don’t know much about the subject, but am posting this in the hopes that someone who does can elucidate the issue.  My basic dilemma is that I have a short bit of code on my single page templates that checks to see if a visitor is from Twitter, and if so, show a little message.  (Not an original idea, I think I saw it on a post at Smashing Magazine).  The code they used didn’t work, but with the help of BigJibby in the Habari IRC channel, I was able to get it working with Habari." />
    <link rel="canonical" href="https://miklb.com/url-shorteners-http-referers-and-301-redirects" />
    <meta property="og:url" content="https://miklb.com/url-shorteners-http-referers-and-301-redirects" />
    <meta property="og:site_name" content="Miklb’s Mindless Ramblings" />
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="2009-06-29T00:00:00+00:00" />
    <link rel="next" href="https://miklb.com/procrastinating-to-get-things-done" title="Procrastinating to Get Things Done" />
    <link rel="prev" href="https://miklb.com/how-about-giving-me-some-credit-hosers" title="How About Giving Me Some Credit Hosers" />
    <script type="application/ld+json">
      {
          "@context": "http://schema.org",
          "@type": "BlogPosting",
          "headline": "URL Shorteners, HTTP Referers and 301 Redirects",
          "datePublished": "2009-06-29T00:00:00+00:00",
          "description": "I’ll start by saying I don’t know much about the subject, but am posting this in the hopes that someone who does can elucidate the issue.  My basic dilemma is that I have a short bit of code on my single page templates that checks to see if a visitor is from Twitter, and if so, show a little message.  (Not an original idea, I think I saw it on a post at Smashing Magazine).  The code they used didn’t work, but with the help of BigJibby in the Habari IRC channel, I was able to get it working with Habari.",
          "logo": "https://miklb.compublic/favicon.png",
          "url": "https://miklb.com/url-shorteners-http-referers-and-301-redirects"
        }
    </script>
    <!-- End Jekyll SEO tag -->
  </head>
  <body class="h-feed">
    <header class="site-header" role="banner">
      <a class="site-title" href="/">Miklb's Mindless Ramblings</a>
      <nav class="site-nav" role="navigation">
        <ul>
          <li itemprop="url"><a  class="" href="/about/">About</a></li>
        </ul>
      </nav>
    </header>
    <div id="wrapper">
      <main role="main">
        <div class="content">
          <article class="post h-entry">
            <header class="entry-header">
              <h1 class="post-title p-name">
                <a class="u-url" rel="bookmark" href="/url-shorteners-http-referers-and-301-redirects">
                  URL Shorteners, HTTP Referers and 301 Redirects
		  </a>
              </h1>
              <h2 class="p-summary p-bridgy-twitter-content">
              </h2>
            </header>
            <div class="e-content">
              <p>I’ll start by saying I don’t know much about the subject, but am posting this in the hopes that someone who does can elucidate the issue.  My basic dilemma is that I have a short bit of code on my single page templates that checks to see if a visitor is from Twitter, and if so, show a little message.  (Not an original idea, I think I saw it on a post at Smashing Magazine).  The code they used didn’t work, but with the help of <a href="http://mattread.com/">BigJibby</a> in the Habari IRC channel, I was able to get it working with Habari.</p>
              <p>I more or less forgot about it, until a few people noticed it and asked if it was a plugin.  When I replied it wasn’t, they asked if I could make it into one.  So it went into a to-do list I keep of Habari related ideas.  This evening I began working on it, and while troubleshooting how to actually output something to the entry single template (that’s a whole other can of worms), I discovered the code snippet wasn’t working.  With the help of <a href="http://twofishcreative.com/michael/blog/">Michael</a>, we discovered the problem wasn’t with the code snippet, rather it was with the URL shorteners.  Twitter recently started defaulting to <a href="http://bit.ly">Bit.ly</a>, and I recently began experimenting with <a href="http://tr.im">Tr.im</a>,  <span class="pquote-r">both of which weren’t sending twitter.com as the referrer.  Rather, due to their 301 redirect they return <strong>NULL</strong>.  Which in a nut shell sucks. </span></p>
              <p>Somehow Google Analytics is able to track referrals from Twitter, as last week when I had a huge upsurge in traffic from the popularity of the <a href="http://miklb.com/infinite-summer-bookmarks">Infinite Summer Bookmarks</a>, I’m seeing 50 visitors from Twitter the first day (of the 785, by far a record for this little weblog).</p>
              <p>At this point, finishing the plugin seems moot, as the only way to be sure that visitors will actually see the message would be to use a URL shortener that doesn’t return NULL, of which, the only one we found that to not be the case was Owen’s <a href="http://pastoid.com">Pastoid</a>.  I didn’t test Tinyurl, nor was I interested in looking for others.  The disappointment had already set in.  Besides that, if you are auto posting to Twitter with a plugin, you wouldn’t have the option to use a different shortener.</p>
              <p>So kind readers/stumble-uponers, if anyone has a solution to this problem, please enlighten me.  Meanwhile, I’ll work out the issue with Habari and my desire to output content on a single entry template within the content output, not above the body tag.</p>
              <p>For anyone interested in the snippet of code I am using:</p>
              <p><code>if ( parse_url($_SERVER['HTTP_REFERER'], PHP_URL_HOST) == 'twitter.com' ) {
	    echo "&lt;h2 class='twittervisit'&gt;Welcome, Twitter visitor! If this post is useful, don't hesitate to retweet!&lt;/h2&gt;";
                </code></p>
            </div>
            <footer class="entry-footer">
              <div class="entry-meta">
                <div class="h-card">
                  <a href="" class="entry-author-link" rel="author">
                    <div class="auth-img">
                      <img src="http://cdn.miklb.com/images/profile_4_16.jpg" alt="Michael Bishop" class="u-photo">
                    </div>
                    <p>Author: <span class="p-author">Michael Bishop</span></p>
                  </a>
                </div>
                <div class="meta-wrap">
                  <p><a href="">URL Shorteners, HTTP Referers and 301 Redirects </a> posted on <time datetime="2009-06-29T00:00:00+00:00" class="dt-time post-date">29 Jun 2009</time>.</p>
                  <p>This entry has been tagged with the keywords: <span class="tag">habari </span><span class="tag">twitter </span><span class="tag">bitly </span><span class="tag">trim </span><span class="tag">301-redirect </span><span class="tag">http_referer </span><span class="tag">-_server </span><span class="tag">url-shorteners </span></p>
                </div>
              </div>
            </footer>
          </article>
          <script id="webmention-hosted">
            (function () {
            var sn = document.createElement("script"), s = document.getElementsByTagName("script")[0], url;
            url = document.querySelectorAll ? document.querySelectorAll("link[rel~=canonical]") : false;
            url = url && url[0] ? url[0].href : false;
            sn.type = "text/javascript"; sn.async = true;
            sn.src = "//webmention.herokuapp.com/api/embed?url=" + encodeURIComponent(url || window.location);
            s.parentNode.insertBefore(sn, s);
            }());
          </script>
        </div>
      </main>
    </div>
    <footer class="site-footer" role="contentinfo">
      <p>
        Built with <a href="https://github.com/miklb/jekyll-indieweb">Jekyll</a> on <a href="https://indiewebcamp.com)
">IndieWeb principles</a>
      </p>
    </footer>
  </body>
</html>
